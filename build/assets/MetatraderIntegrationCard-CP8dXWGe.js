import{m as G,u as R,a as W,b as Y,r as y,j as a,B as K,t as c,h as e,p as O}from"./index-BOV8MqzO.js";import{C as q,D as z,E as D,F as B,G as J,H as Q}from"./DashboardActions-BWWaixGw.js";import{S as V}from"./SettingCard-DDHXlI_V.js";import{I as X,a as Z}from"./IntegrationUploadImage-8k82LIm2.js";import{B as ee}from"./ButtonComponentWhite-GwdnuTI9.js";import{D as C,U as te}from"./uploading-DtHGzmtt.js";import{l as ae}from"./stack-D1CCVIei.js";/* empty css                    */const me=({role:n,type:M})=>{const[P,se]=G(),v=R(s=>s.auth),j=W(),_=Y(),[p,T]=y.useState(0),[t,S]=y.useState({acc_name:"",acc_password:"",acc_id:"",server_name:""}),[k,r]=y.useState(!1),[A,U]=y.useState({per_hour:"0"}),[F,L]=y.useState(""),[b,H]=y.useState(C);y.useEffect(()=>{const s=P.get("level_index");s&&(s!=="0"&&s!=="1"&&s!=="2"&&s!=="3"&&_("/dashboard/integrations/home"),T(parseInt(s)))},[]);const $=async()=>{if(!t.acc_name||!t.acc_password||!t.acc_id||!t.server_name){c.warning("Please Input Account All Informations");return}r(!0);let s=!1;M===0?await q(t.server_name).then(async m=>{if(m.status!==200){c.error("The specified company name could not be found. Please confirm that the company name is correct!"),r(!1);return}const u=m.data[0].results,i=await(u==null?void 0:u.find(l=>l.name===t.server_name));if(!i){c.error("Metatrader address not found! Please input address correctly!"),r(!1);return}const d=i==null?void 0:i.access;for(let l=0;l<(d==null?void 0:d.length);l++){const x=d[l].split(":");let h=x[0],f="";x.length>1&&(f=x[1]),await z({user:t.acc_id,password:t.acc_password,host:h,port:f}).then(async g=>{if(!s&&g.status==200){if(s=!0,n==="master"){const o={token:g.data,encrypted_acc_id:e(t.acc_id),encrypted_acc_password:e(t.acc_password),encrypted_acc_server_name:e(t.server_name),encrypted_host:e(h),encrypted_port:e(f),encrypted_acc_name:e(t.acc_name),encrypted_type:e("mt4"),encrypted_id:e(v.user.id),encrypted_profit_share:e(A),description:F,encrypted_index_level:e(p),avatar:b===C?"":b};await j(D({encrypted:o})).then(w=>{w.status===200?c.success("Master account has been added successfully!"):w.status===201&&c.warning(w.data),r(!1),_("/dashboard/masters")}).catch(()=>{r(!1)});return}else if(n==="copier"){const o={token:g.data,encrypted_acc_id:e(t.acc_id),encrypted_acc_password:e(t.acc_password),encrypted_acc_server_name:e(t.server_name),encrypted_host:e(h),encrypted_port:e(f),encrypted_acc_name:e(t.acc_name),encrypted_type:e("mt4"),encrypted_id:e(v.user.id),avatar:v.user.avatar};await j(B({encrypted:o})).then(w=>{w.status===200?c.success("Copier account has been added successfully!"):w.status===201&&c.warning(w.data),r(!1),_("/dashboard/copiers")}).catch(()=>{r(!1)});return}}})}}):await J(t.server_name).then(async m=>{const I=m[0].results,u=await(I==null?void 0:I.find(d=>d.name===t.server_name));if(!u){c.error("Metatrader address not found! Please input address correctly!"),r(!1);return}const i=u==null?void 0:u.access;for(let d=0;d<(i==null?void 0:i.length);d++){const l=i[d].split(":");let x=l[0],h="";l.length>1&&(h=l[1]),await Q({user:t.acc_id,password:t.acc_password,host:x,port:h}).then(async f=>{if(!s&&f.status==200){if(s=!0,n==="master"){const g={token:f.data,encrypted_acc_id:e(t.acc_id),encrypted_acc_password:e(t.acc_password),encrypted_acc_server_name:e(t.server_name),encrypted_host:e(x),encrypted_port:e(h),encrypted_acc_name:e(t.acc_name),encrypted_type:e("mt5"),encrypted_id:e(v.user.id),encrypted_profit_share:e(A),description:F,encrypted_index_level:e(p),avatar:b===C?"":b};await j(D({encrypted:g})).then(o=>{o.status===200?c.success("Master account has been added successfully!"):o.status===201&&c.warning(o.data),r(!1),_("/dashboard/masters")}).catch(()=>{r(!1)});return}else if(n==="copier"){const g={token:f.data,encrypted_acc_id:e(t.acc_id),encrypted_acc_password:e(t.acc_password),encrypted_acc_server_name:e(t.server_name),encrypted_host:e(x),encrypted_port:e(h),encrypted_acc_name:e(t.acc_name),encrypted_type:e("mt5"),encrypted_id:e(v.user.id),avatar:v.user.avatar};await j(B({encrypted:g})).then(o=>{o.status===200?c.success("Copier account has been added successfully!"):o.status===201&&c.warning(o.data),r(!1),_("/dashboard/copiers")}).catch(()=>{r(!1)});return}}})}}).catch(()=>{r(!1)}),s||c.error("Invalid Account!"),r(!1)},N=(s,m)=>{s==="acc_password"?S({...t,[s]:m}):O(m)&&S({...t,[s]:m})},E=()=>{n==="master"&&_(`/dashboard/integrations/masters/selectplatform?index=${p}`),n==="copier"&&_("/dashboard/integrations/copiers/selectplatform")};return a.jsx(a.Fragment,{children:a.jsx("div",{className:"mt-16",children:a.jsxs("div",{className:"relative w-full h-auto rounded-xl rounded-tl-[30px] border-2 border-color4 bg-gradient-to-br from-[#FFFFFF03] to-[#FFFFFF01]",children:[a.jsx("img",{src:"/icons/metatrader-left.webp",alt:"Top left icon",title:"This is metatrader icon",className:"absolute top-0 left-0 w-[100px] h-[100px]"}),a.jsx("img",{src:"/icons/top-right.webp",alt:"Top right icon",title:"This is general icon",className:"absolute top-[18px] right-[18px] w-[67px] h-[67px]"}),a.jsx("img",{src:"/icons/bottom-right.webp",alt:"Bottom right icon",title:"This is general icon",className:"absolute bottom-[18px] right-[18px] w-[67px] h-[67px]"}),a.jsx("img",{src:"/icons/bottom-left.webp",alt:"Bottom left icon",title:"This is general icon",className:"absolute bottom-[18px] left-[18px] w-[67px] h-[67px]"}),k?a.jsx(X,{}):a.jsx("div",{className:"my-16 flex items-center justify-center",children:a.jsxs("div",{className:"w-[80%] flex flex-col items-center justify-center",children:[a.jsxs("div",{className:"w-full flex gap-5 items-center",children:[a.jsxs("h2",{className:"hidden md:block text-[32px] text-white",children:[M===0?"Metatrader 4 ":"Metatrader 5 ",n==="master"?"Master":"Copier"]}),a.jsx("h2",{className:"block md:hidden text-[32px] text-white",children:M===0?"Metatrader 4":"Metatrader 5"}),n==="master"&&p?a.jsx("img",{src:ae[p],alt:"Level icon",title:"This is icon to show level",className:"h-[28px]"}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"mt-8 w-full font-bold text-xl text-white",children:"Basic information :"}),a.jsxs("div",{className:"my-8 w-full flex justify-between",children:[a.jsx("div",{className:`${n==="copier"&&"hidden"} w-[130px] h-[130px] rounded-full border-4 ${p===3?"border-herocolor":p===2?"border-goldcolor":p===1?"border-silvercolor":"border-color4"}`,children:a.jsx(Z,{avatarURL:b,setAvatarURL:H,DefaultImage:C,UploadingAnimation:te,className:"w-[130px] h-[130px]",className1:"bottom-12 right-[68px]",className2:"bottom-12 right-[32px]"})}),a.jsxs("div",{className:`${n==="master"?"integration-input-group":"w-full"} grid grid-cols-1 md:grid-cols-2 gap-4`,children:[a.jsx("input",{value:t.acc_id,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Account Id",onChange:s=>N("acc_id",s.target.value)}),a.jsx("input",{type:"password",value:t.acc_password,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Account Password",onChange:s=>N("acc_password",s.target.value)}),a.jsx("input",{value:t.server_name,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Server Name",onChange:s=>N("server_name",s.target.value)}),a.jsx("input",{value:t.acc_name,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Account Name (Displayed on this platform)",onChange:s=>N("acc_name",s.target.value)})]})]}),a.jsx("div",{className:`w-full ${n==="copier"&&"hidden"}`,children:a.jsx(V,{profit:A,setProfit:U,description:F,setDescription:L})}),a.jsxs("div",{className:"mt-6 w-full flex justify-end gap-5",children:[a.jsx(ee,{text:"GO BACK",className:"w-full sm:w-[216px] h-[56px]",handleClick:E}),a.jsx(K,{text:"+ ADD",className:"w-full sm:w-[216px] h-[56px]",handleClick:$})]})]})})]})})})};export{me as M};
