import{g as H,u as G,a as R,b as W,r as g,j as a,B as Y,t as r}from"./index-C-wVKE08.js";import{B as T,C as K,D as A,E as F,F as O,G as q}from"./DashboardActions-TGnx1ONk.js";import{S as z}from"./SettingCard-CRa5A90l.js";import{I as J,a as Q}from"./IntegrationUploadImage-CEw5p1GB.js";import{B as V}from"./ButtonComponentWhite-CNd9_3CR.js";import{D as y,U as X}from"./uploading-CE6R_eEN.js";import{l as Z}from"./stack-BlqWHnTg.js";const ie=({role:c,type:I})=>{const[S,ee]=H(),_=G(t=>t.auth),b=R(),h=W(),[l,k]=g.useState(0),[e,D]=g.useState({acc_name:"",acc_password:"",acc_id:"",server_name:""}),[P,s]=g.useState(!1),[C,B]=g.useState({per_hour:"0"}),[M,U]=g.useState(""),[v,L]=g.useState(y);g.useEffect(()=>{const t=S.get("level_index");t&&(t!=="0"&&t!=="1"&&t!=="2"&&t!=="3"&&h("/dashboard/integrations/home"),k(parseInt(t)))},[]);const $=async()=>{if(!e.acc_name||!e.acc_password||!e.acc_id||!e.server_name){r.warning("Please Input Account All Informations");return}s(!0);let t=!1;I===0?await T(e.server_name).then(async w=>{if(w.status!==200){r.error("The specified company name could not be found. Please confirm that the company name is correct!"),s(!1);return}const m=w.data[0].results,i=await(m==null?void 0:m.find(d=>d.name===e.server_name));if(!i){r.error("Metatrader address not found! Please input address correctly!"),s(!1);return}const o=i==null?void 0:i.access;for(let d=0;d<(o==null?void 0:o.length);d++){const f=o[d].split(":");let u=f[0],p="";f.length>1&&(p=f[1]),await K({user:e.acc_id,password:e.acc_password,host:u,port:p}).then(async n=>{if(!t&&n.status==200){if(t=!0,c==="master"){await b(A({token:n.data,acc_id:e.acc_id,acc_password:e.acc_password,acc_server_name:e.server_name,host:u,port:p,acc_name:e.acc_name,type:"mt4",id:_.user.id,profit_share:C,description:M,avatar:v===y?"":v,index_level:l})).then(x=>{x.status===200?r.success("Master account has been added successfully!"):x.status===201&&r.warning(x.data),s(!1),h("/dashboard/masters")}).catch(()=>{s(!1)});return}else if(c==="copier"){await b(F({token:n.data,acc_id:e.acc_id,acc_password:e.acc_password,acc_server_name:e.server_name,host:u,port:p,acc_name:e.acc_name,type:"mt4",id:_.user.id,avatar:_.user.avatar})).then(x=>{x.status===200?r.success("Copier account has been added successfully!"):x.status===201&&r.warning(x.data),s(!1),h("/dashboard/copiers")}).catch(()=>{s(!1)});return}}})}}):await O(e.server_name).then(async w=>{const N=w[0].results,m=await(N==null?void 0:N.find(o=>o.name===e.server_name));if(!m){r.error("Metatrader address not found! Please input address correctly!"),s(!1);return}const i=m==null?void 0:m.access;for(let o=0;o<(i==null?void 0:i.length);o++){const d=i[o].split(":");let f=d[0],u="";d.length>1&&(u=d[1]),await q({user:e.acc_id,password:e.acc_password,host:f,port:u}).then(async p=>{if(!t&&p.status==200){if(t=!0,c==="master"){await b(A({token:p.data,acc_id:e.acc_id,acc_password:e.acc_password,acc_server_name:e.server_name,host:f,port:u,acc_name:e.acc_name,type:"mt5",id:_.user.id,profit_share:C,description:M,avatar:v===y?"":v,index_level:l})).then(n=>{n.status===200?r.success("Master account has been added successfully!"):n.status===201&&r.warning(n.data),s(!1),h("/dashboard/masters")}).catch(()=>{s(!1)});return}else if(c==="copier"){await b(F({token:p.data,acc_id:e.acc_id,acc_password:e.acc_password,acc_server_name:e.server_name,host:f,port:u,acc_name:e.acc_name,type:"mt5",id:_.user.id,avatar:_.user.avatar})).then(n=>{n.status===200?r.success("Copier account has been added successfully!"):n.status===201&&r.warning(n.data),s(!1),h("/dashboard/copiers")}).catch(()=>{s(!1)});return}}})}}).catch(()=>{s(!1)}),t||r.error("Invalid Account!"),s(!1)},j=(t,w)=>{D({...e,[t]:w})},E=()=>{c==="master"&&h(`/dashboard/integrations/masters/selectplatform?index=${l}`),c==="copier"&&h("/dashboard/integrations/copiers/selectplatform")};return a.jsx(a.Fragment,{children:a.jsx("div",{className:"mt-16",children:a.jsxs("div",{className:"relative w-full h-auto rounded-xl rounded-tl-[30px] border-2 border-color4 bg-gradient-to-br from-[#FFFFFF03] to-[#FFFFFF01]",children:[a.jsx("img",{src:"/icons/metatrader-left.webp",className:"absolute top-0 left-0 w-[100px] h-[100px]"}),a.jsx("img",{src:"/icons/top-right.webp",className:"absolute top-[18px] right-[18px] w-[67px] h-[67px]"}),a.jsx("img",{src:"/icons/bottom-right.webp",className:"absolute bottom-[18px] right-[18px] w-[67px] h-[67px]"}),a.jsx("img",{src:"/icons/bottom-left.webp",className:"absolute bottom-[18px] left-[18px] w-[67px] h-[67px]"}),P?a.jsx(J,{}):a.jsx("div",{className:"my-16 flex items-center justify-center",children:a.jsxs("div",{className:"w-[80%] flex flex-col items-center justify-center",children:[a.jsxs("div",{className:"w-full flex gap-5 items-center",children:[a.jsxs("h2",{className:"hidden md:block text-[32px] text-white",children:[I===0?"Metatrader 4 ":"Metatrader 5 ",c==="master"?"Master":"Copier"]}),a.jsx("h2",{className:"block md:hidden text-[32px] text-white",children:I===0?"Metatrader 4":"Metatrader 5"}),c==="master"&&l?a.jsx("img",{src:Z[l],className:"h-[28px]"}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"mt-8 w-full font-bold text-xl text-white",children:"Basic information :"}),a.jsxs("div",{className:"my-8 w-full flex justify-between",children:[a.jsx("div",{className:`${c==="copier"&&"hidden"} w-[130px] h-[130px] rounded-full border-4 ${l===3?"border-herocolor":l===2?"border-goldcolor":l===1?"border-silvercolor":"border-color4"}`,children:a.jsx(Q,{avatarURL:v,setAvatarURL:L,DefaultImage:y,UploadingAnimation:X,className:"w-[130px] h-[130px]",className1:"bottom-12 right-[68px]",className2:"bottom-12 right-[32px]"})}),a.jsxs("div",{className:`${c==="master"?"integration-input-group":"w-full"} grid grid-cols-1 md:grid-cols-2 gap-4`,children:[a.jsx("input",{value:e.acc_id,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Account Id",onChange:t=>j("acc_id",t.target.value)}),a.jsx("input",{type:"password",value:e.acc_password,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Account Password",onChange:t=>j("acc_password",t.target.value)}),a.jsx("input",{value:e.server_name,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Server Name",onChange:t=>j("server_name",t.target.value)}),a.jsx("input",{value:e.acc_name,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Account Name (Displayed on this platform)",onChange:t=>j("acc_name",t.target.value)})]})]}),a.jsx("div",{className:`w-full ${c==="copier"&&"hidden"}`,children:a.jsx(z,{profit:C,setProfit:B,description:M,setDescription:U})}),a.jsxs("div",{className:"mt-6 w-full flex justify-end gap-5",children:[a.jsx(V,{text:"GO BACK",className:"w-full sm:w-[216px] h-[56px]",handleClick:E}),a.jsx(Y,{text:"+ ADD",className:"w-full sm:w-[216px] h-[56px]",handleClick:$})]})]})})]})})})};export{ie as M};
