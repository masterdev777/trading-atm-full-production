import{k as $,u as E,a as G,b as R,r as w,j as a,B as W,t as r}from"./index-C5dHWHVl.js";import{C as Y,D as K,E as F,F as S,G as O,H as q}from"./DashboardActions-C9q7Oh-I.js";import{S as z}from"./SettingCard-CImHKM0Z.js";import{I as J,a as Q}from"./IntegrationUploadImage-C13xmlOl.js";import{B as V}from"./ButtonComponentWhite-Dt3BG52z.js";import{D as y,U as X}from"./uploading-Qqmo6sSF.js";import{i as Z}from"./Functions-COzV2hZz.js";import{l as ee}from"./stack-BlqWHnTg.js";const le=({role:c,type:I})=>{const[D,ae]=$(),_=E(t=>t.auth),b=G(),f=R(),[l,k]=w.useState(0),[e,A]=w.useState({acc_name:"",acc_password:"",acc_id:"",server_name:""}),[B,s]=w.useState(!1),[C,P]=w.useState({per_hour:"0"}),[M,T]=w.useState(""),[v,U]=w.useState(y);w.useEffect(()=>{const t=D.get("level_index");t&&(t!=="0"&&t!=="1"&&t!=="2"&&t!=="3"&&f("/dashboard/integrations/home"),k(parseInt(t)))},[]);const L=async()=>{if(!e.acc_name||!e.acc_password||!e.acc_id||!e.server_name){r.warning("Please Input Account All Informations");return}s(!0);let t=!1;I===0?await Y(e.server_name).then(async m=>{if(m.status!==200){r.error("The specified company name could not be found. Please confirm that the company name is correct!"),s(!1);return}const p=m.data[0].results,i=await(p==null?void 0:p.find(d=>d.name===e.server_name));if(!i){r.error("Metatrader address not found! Please input address correctly!"),s(!1);return}const o=i==null?void 0:i.access;for(let d=0;d<(o==null?void 0:o.length);d++){const x=o[d].split(":");let u=x[0],h="";x.length>1&&(h=x[1]),await K({user:e.acc_id,password:e.acc_password,host:u,port:h}).then(async n=>{if(!t&&n.status==200){if(t=!0,c==="master"){await b(F({token:n.data,acc_id:e.acc_id,acc_password:e.acc_password,acc_server_name:e.server_name,host:u,port:h,acc_name:e.acc_name,type:"mt4",id:_.user.id,profit_share:C,description:M,avatar:v===y?"":v,index_level:l})).then(g=>{g.status===200?r.success("Master account has been added successfully!"):g.status===201&&r.warning(g.data),s(!1),f("/dashboard/masters")}).catch(()=>{s(!1)});return}else if(c==="copier"){await b(S({token:n.data,acc_id:e.acc_id,acc_password:e.acc_password,acc_server_name:e.server_name,host:u,port:h,acc_name:e.acc_name,type:"mt4",id:_.user.id,avatar:_.user.avatar})).then(g=>{g.status===200?r.success("Copier account has been added successfully!"):g.status===201&&r.warning(g.data),s(!1),f("/dashboard/copiers")}).catch(()=>{s(!1)});return}}})}}):await O(e.server_name).then(async m=>{const N=m[0].results,p=await(N==null?void 0:N.find(o=>o.name===e.server_name));if(!p){r.error("Metatrader address not found! Please input address correctly!"),s(!1);return}const i=p==null?void 0:p.access;for(let o=0;o<(i==null?void 0:i.length);o++){const d=i[o].split(":");let x=d[0],u="";d.length>1&&(u=d[1]),await q({user:e.acc_id,password:e.acc_password,host:x,port:u}).then(async h=>{if(!t&&h.status==200){if(t=!0,c==="master"){await b(F({token:h.data,acc_id:e.acc_id,acc_password:e.acc_password,acc_server_name:e.server_name,host:x,port:u,acc_name:e.acc_name,type:"mt5",id:_.user.id,profit_share:C,description:M,avatar:v===y?"":v,index_level:l})).then(n=>{n.status===200?r.success("Master account has been added successfully!"):n.status===201&&r.warning(n.data),s(!1),f("/dashboard/masters")}).catch(()=>{s(!1)});return}else if(c==="copier"){await b(S({token:h.data,acc_id:e.acc_id,acc_password:e.acc_password,acc_server_name:e.server_name,host:x,port:u,acc_name:e.acc_name,type:"mt5",id:_.user.id,avatar:_.user.avatar})).then(n=>{n.status===200?r.success("Copier account has been added successfully!"):n.status===201&&r.warning(n.data),s(!1),f("/dashboard/copiers")}).catch(()=>{s(!1)});return}}})}}).catch(()=>{s(!1)}),t||r.error("Invalid Account!"),s(!1)},j=(t,m)=>{t==="acc_password"?A({...e,[t]:m}):Z(m)&&A({...e,[t]:m})},H=()=>{c==="master"&&f(`/dashboard/integrations/masters/selectplatform?index=${l}`),c==="copier"&&f("/dashboard/integrations/copiers/selectplatform")};return a.jsx(a.Fragment,{children:a.jsx("div",{className:"mt-16",children:a.jsxs("div",{className:"relative w-full h-auto rounded-xl rounded-tl-[30px] border-2 border-color4 bg-gradient-to-br from-[#FFFFFF03] to-[#FFFFFF01]",children:[a.jsx("img",{src:"/icons/metatrader-left.webp",alt:"Top left icon",title:"This is metatrader icon",className:"absolute top-0 left-0 w-[100px] h-[100px]"}),a.jsx("img",{src:"/icons/top-right.webp",alt:"Top right icon",title:"This is general icon",className:"absolute top-[18px] right-[18px] w-[67px] h-[67px]"}),a.jsx("img",{src:"/icons/bottom-right.webp",alt:"Bottom right icon",title:"This is general icon",className:"absolute bottom-[18px] right-[18px] w-[67px] h-[67px]"}),a.jsx("img",{src:"/icons/bottom-left.webp",alt:"Bottom left icon",title:"This is general icon",className:"absolute bottom-[18px] left-[18px] w-[67px] h-[67px]"}),B?a.jsx(J,{}):a.jsx("div",{className:"my-16 flex items-center justify-center",children:a.jsxs("div",{className:"w-[80%] flex flex-col items-center justify-center",children:[a.jsxs("div",{className:"w-full flex gap-5 items-center",children:[a.jsxs("h2",{className:"hidden md:block text-[32px] text-white",children:[I===0?"Metatrader 4 ":"Metatrader 5 ",c==="master"?"Master":"Copier"]}),a.jsx("h2",{className:"block md:hidden text-[32px] text-white",children:I===0?"Metatrader 4":"Metatrader 5"}),c==="master"&&l?a.jsx("img",{src:ee[l],alt:"Level icon",title:"This is icon to show level",className:"h-[28px]"}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"mt-8 w-full font-bold text-xl text-white",children:"Basic information :"}),a.jsxs("div",{className:"my-8 w-full flex justify-between",children:[a.jsx("div",{className:`${c==="copier"&&"hidden"} w-[130px] h-[130px] rounded-full border-4 ${l===3?"border-herocolor":l===2?"border-goldcolor":l===1?"border-silvercolor":"border-color4"}`,children:a.jsx(Q,{avatarURL:v,setAvatarURL:U,DefaultImage:y,UploadingAnimation:X,className:"w-[130px] h-[130px]",className1:"bottom-12 right-[68px]",className2:"bottom-12 right-[32px]"})}),a.jsxs("div",{className:`${c==="master"?"integration-input-group":"w-full"} grid grid-cols-1 md:grid-cols-2 gap-4`,children:[a.jsx("input",{value:e.acc_id,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Account Id",onChange:t=>j("acc_id",t.target.value)}),a.jsx("input",{type:"password",value:e.acc_password,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Account Password",onChange:t=>j("acc_password",t.target.value)}),a.jsx("input",{value:e.server_name,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Your Metatrader Server Name",onChange:t=>j("server_name",t.target.value)}),a.jsx("input",{value:e.acc_name,className:"focus:outline-none h-[56px] rounded-lg border-2 border-color4 px-4 text-white text-sm bg-transparent",placeholder:"Input Account Name (Displayed on this platform)",onChange:t=>j("acc_name",t.target.value)})]})]}),a.jsx("div",{className:`w-full ${c==="copier"&&"hidden"}`,children:a.jsx(z,{profit:C,setProfit:P,description:M,setDescription:T})}),a.jsxs("div",{className:"mt-6 w-full flex justify-end gap-5",children:[a.jsx(V,{text:"GO BACK",className:"w-full sm:w-[216px] h-[56px]",handleClick:H}),a.jsx(W,{text:"+ ADD",className:"w-full sm:w-[216px] h-[56px]",handleClick:L})]})]})})]})})})};export{le as M};
